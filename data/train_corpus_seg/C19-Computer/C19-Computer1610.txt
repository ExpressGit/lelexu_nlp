信息 与 控制 
 InformationandControl 
 1999 年 　 第 28 卷 　 第 5 期 　 Vol.28 　 No.5 　 1999 
 
 
 
 神经元 自 适应 预测 PID 控制器 及 实现 
 
 杨 　 智 　 高 　 靖 
 
 　 　 摘 　 要 ： 采用 单 神经元 构成 PID 控制器 ， 并 和 预测 控制 结合 克服 时滞 对 控制系统 的 影响 ． 对大 时滞 大 惯性 的 电 加热炉 的 实时控制 结果表明 ， 这种 自 适应 控制算法 切实可行 ， 且 具有 较强 的 鲁棒性 ， 适合 于 控制 大 时滞 被控 过程 ． 
 　 　 关键词 ： 神经元 ， 最优 预测 ， PID ， 时滞 系统 ， 工控机 
 　 　 中 图 分类号 ： TP13 　 　 　 　 　 　 文献 标识码 ： B 
 
 ANADAPTIVENEURONPIDCONTROLLERWITHOPTIMAL 
 PREDICTIVEANDITSREALIZATION 
 YANGZhiGAOJing 
 ( Dept . ofElectricalandinformationengineering , GansuUniv . ofTech . , Lanzhou730050 ) 
 Abstract : Inthispaper , anadaptiveneuronPIDcontrollerwithoptimalpredictionwhichissuitablefortheprocesswithunknowntime - varyingdelay , disturbanceandtime - varyingparametersispresented . Thecontrolalgorithmcombinedintelligentcontrolwithpredictivecontrol . Thereal - timetemperaturecontrolresultoftheelectricalfurnaceshowsthatthepresentedadaptiveneuronPIDcontrollerwithoptimalpredictionmayberealizedandhashighrobustness , especiallyforthedelaysystems . 
 Keywords : neuron ， adaptivecontrol ， predictivecontrol ， PID ， delaysystems ， industrialprocesscomputer 
 
 1 　 引言 
 　 　 常规 的 PID 调节器 是 一种 应用 十分 广泛 且 比较 成熟 的 控制算法 ， 对于 受控对象 结构 和 参数 已知 的 场合 ， 可 获得 较 好 的 控制 效果 ． 但 对于 工业 过程 中 常见 的 慢 时变 大 时滞 控制系统 ， 由于 时滞 变化 可能 会 使 系统 不 稳定 ， 常规 的 PID 调节器 不能 获得 良好 的 控制 品质 ． 神经元 自 适应 预测 PID 控制算法 利用 模型 加权 函数 的 误差 函数 确定 时滞 ， 然后 与 预测 控制 的 超前 预测 功能 结合 ， 起到 克服 时变 时滞 的 作用 ， 并 利用 神经元 构成 PID 控制器 实现 参数 自 适应 ． 这种 自 适应 控制算法 适合 控制 有 扰动 ， 参数 时变 尤其 时滞 时变 的 大 时滞 被控 过程 ． 对大 时滞 大 惯性 的 电 加热炉 的 实时控制 表明 ， 提出 的 神经元 自 适应 预测 PID 控制器 切实可行 ， 可以 构成 较 实用 的 工程 控制器 ． 
 2 　 神经元 自 适应 预测 PID 控制算法 
 　 　 神经元 自 适应 预测 PID 控制系统 结构图 如图 1 所示 ． 
 
 图 1 神经元 自 适应 预测 PID 控制系统 结构图 
 
 2.1 时滞 的 辨识 
 　 　 假设 被控 过程 的 动态 特性 可用 下列 差分 方程 表示 
 A ( z - 1 ) y ( k ) = B ( z - 1 ) u ( k - d - 1 ) + C ( z - 1 ) ε ( k ) 　 　 　 　 　 　 　 　 　 　 ( 1 ) 
 其中 , A ( z - 1 ) = 1 + a1z - 1 + … + anz - n ； B ( z - 1 ) = b1 + b2z - 1 + … + bnz - n + 1 , b1 ≠ 0 ； C ( z - 1 ) = 1 + c1z - 1 + … + cnz - n ; u ( k ) 、 y ( k ) 分别 是 过程 的 控制 和 输出 序列 ； ε ( k ) 是 环境 干扰 ， 为 随机变量 ； 是 输出 对 输入 响应 的 时滞 时间 ， 是 过程 的 阶次 ． 
 作者 在 文 [ 2 ] 中 ， 用 一个 修正 的 广义 模型 重写 式 ( 1 ) ， 得 
 A ( z - 1 ) y ( k ) = B * ( z - 1 ) u ( k ) 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 2 ) 
 其中 ， B * ( z - 1 ) = bn1z - 1 + … + bnn + dmaxz - ( n + dmax ) ； dmax 是 过程 时滞 时间 的 上限 ， 并 预先 可知 ， 且 0 ≤ d ≤ dmax - 1 ， 则 存在 下列 方程 
 b * i = 0 , i = 1 , … , d ; bnj = bj - d , j = 1 + d , … , n + d 
 b * l = 0 , l = n + 1 + d , … , n + dmax 
 用 递推 的 最小 二 乘法 对 修正 的 广义 模型 进行 参数估计 ， 有 
 
 X = [ - y ( k - 1 ) , … , - y ( k - n ) ; u ( k - 1 ) , … , u ( k - n - dmax ) ] 
 当 k → ∞ 时 ， * i 和 * l → 0 ， 对于 确定 的 k ， * i 、 * l 为 一较 小 的 值 ． 辨识 出 * ( z - 1 ) 的 系数 后 ， 就 可 计算误差 函数 
 F ( d ) = | * ( 1 ) - * d ( 1 ) | 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 3 ) 
 其中 ， * ( 1 ) = ∑ * j , i = 1 , … , n + dmax ; 
 当 F ( d ) 为 最 小时 ， 对应 的 d 就是 时滞 时间 ． 
 2.2 最优 预测 的 设计 
 由 Diophantine 方程 
 C ( z - 1 ) = A ( z - 1 ) F ( z - 1 ) + z - d - 1G ( z - 1 ) 　 　 　 　 　 　 　 　 　 　 　 ( 4 ) 
 其中 ， F ( z - 1 ) = 1 + f1z - 1 + … + fdz - d ; G ( z - 1 ) = g0 + g1z - 1 + … + gn - 1z - n + 1 ． 
 由式 ( 1 ) 和 式 ( 4 ) 可 得 
 　 　 ( 5 ) 
 以 ( k + d | k - 1 ) 表示 根据 k - 1 时刻 输入输出 值 对 k + d 时刻 输出量 y ( k + d ) 的 预测值 ， 可以 找到 一个 最优 d 步 预测 * ( k + d | k - 1 ) 使 预测 方差 最小 ， 即 满足 下 式 
 E { y ( k + d ) - * ( k + d | k - 1 ) } 2 ≤ E { y ( k + d ) - ( k + d | k - 1 ) } 2 　 　 　 　 　 　 　 　 　 ( 6 ) 
 式 中 E ( . ) 表示 均值 ． 将式 ( 5 ) 代入 式 ( 6 ) ， 可 得 最优 预测 为 
 　 　 　 　 　 ( 7 ) 
 2.3 克服 时滞 的 理论 分析 
 　 　 控制器 按 PID 控制器 设计 ， 有 
 { yr - y * [ k + d | k - 1 ] } P ( z - 1 ) = R ( z - 1 ) u ( k ) 　 　 　 　 　 　 　 　 　 　 　 　 ( 8 ) 
 其中 ， P ( z - 1 ) = p0 + p1z - 1 + p2z - 2 ; R ( z - 1 ) = 1 - z - 1 . 由式 ( 1 ) 、 式 ( 7 ) 和 式 ( 8 ) 可 得 最优 预测 PID 控制系统 的 输出 为 
 　 ( 9 ) 
 若 使用 常规 的 PID 控制器 ， 系统 的 输出 为 
 　 　 　 　 　 　 ( 10 ) 
 由式 ( 9 ) 看出 ， 最优 预测 PID 控制系统 的 闭环 特征方程 中 已经 没有 时滞 项 ， 即 整个 控制系统 已 消除 了 时滞 对系统 品质 的 影响 ， 而 常规 PID 控制系统 式 ( 10 ) 的 特征方程 中 仍 有 时滞 项 ． 
 2 ． 4 神经元 自 适应 预测 PID 控制器 
 用 梯度 最小 法 极小 化 目标 函数 ， 得 权值 调整 方程 为 
 　 　 　 　 　 　 　 　 　 ( 11 ) 
 其中 ， η i 为 学习 步长 ， 目标 函数 取为 ： 
 　 　 　 　 　 　 　 　 　 　 　 ( 12 ) 
 式 中 ， yr 为 期望 的 设定值 ， yn ( k + d ) 为 被控 过程 输出 的 d 拍 超前 最优 预测 ， d 为 时滞 时间 ． 
 　 　 神经元 的 输出 为 
 　 　 　 　 　 　 　 　 　 ( 13 ) 
 其中 ， kv 为 神经元 放大系数 ， xi ( k ) 为 神经元 输入 ， 取 
 x1 ( k ) = e ( k ) - e ( k - 1 ) 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 
 x2 ( k ) = e ( k ) 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 
 x3 ( k ) = e ( k ) - 2e ( k - 1 ) + e ( k - 2 ) 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 14 ) 
 其中 ， e ( k ) 为 最优 预测值 形成 的 反馈 偏差 ， 用 被控 过程 未来 的 最优 状态 来 控制 其 当前 行为 ， 提高 控制 决策 的 智能性 及 控制系统 的 动态 品质 ， 减小 时滞 对系统 稳定性 的 影响 ． 
 e ( k ) = yr - y * ( k + d ) 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 15 ) 
 而 ， 
 　 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 ( 16 ) 
 可 最终 得出 权值 的 修正 公式 为 
 ( 17 ) 
 其中 ， 神经元 放大系数 kv 的 在线 调整 公式 取为 
 kv ( k ) = kv0 + α [ yr - y * ( k + d ) ] 3 / y2r 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 18 ) 
 式 中 ， kv0 为 kv 的 稳态 值 ， α 为 调整 系数 , 一般 取 kv0 的 十分之一 ． 该 变换 使 偏差 较大 时 kv 也 较大 ， 增加 响应速度 ； 偏差 较 小时 ， kv 近似 为 kv0 ， 减小 超调量 ． 
 　 　 kv 值 的 在线 调整 使得 η i 对 控制 特性 的 影响 甚微 ， 几乎 不予考虑 ． 
 3 　 神经元 自 适应 预测 PID 控制器 在 电 加热炉 上 的 应用 
 　 　 电 加热炉 温度 控制系统 的 硬件 电路 如图 2 所示 ． 
 
 图 2 硬件 电路图 
 　 　 IPC - 610 工控机 及 GENIE3.0 软件包 是 台湾 研华 公司 生产 的 标准 PC 平台 上 的 工控机 及 组态 软件 ． 其 特点 是 成本低 、 易 掌握 及 功能强大 ． GENIE3.0 运行 于 Windows 环境 下 ， 它 的 实时 性能 好 ， 有 丰富 的 图形用户界面 ， 使用 基于 任务 扫描 的 执行 方式 ． 任务 设计 器 使用 工具箱 ， 大大简化 了 过程 控制 和 数据 采集 ． A / D 、 D / O 转换 分别 采用 研华 公司 生产 的 PCL - 818L 、 PCL - 726 电路板 ， PCLD - 789D 是 热电偶 输入 模板 ， 它 完成 热电偶 的 冷端 补偿 及 温度 信号 的 放大 与 转换 ． 
 　 　 根据 控制系统 要求 ， 电阻炉 的 温度 通过 K 型 热电偶 采集 ， 进入 PCLD - 789D 放大 与 冷端 补偿 后 ， 送入 PCL - 818L 完成 A / D 转换 ， 将 信号 送给 主机 后 完成 控制算法 得出 控制 量 ， 经 PCL - 726 完成 D / O 转换 后 输出 给 端子板 ， 控制 固态 继电器 的 通断 ． 由于 GENIE3.0 自带 有 一套 动态 连接 库 驱动程序 ， 所以 无需 为 外围 电路 编写 驱动程序 ． 
 　 　 GENIE 的 运行 方式 是 一种 基于 扫描 的 多任务 执行 方式 ， 编程器 使用 类似 于 VB 的 编程语言 ， 本 温度控制 的 软件设计 部分 由 四个 模块 组成 ， 任务 特性 如表 1 . 
 表 1 任务 特性 表 
 
 　 功能 运行 时间 执行 方式 运行 周期 
 TASK1 辨识 、 预测 PID 控制 、 滤波 永远 立即 5S 
 TASK2 占空比 控制 　 命令式 100ms 
 TASK3 初始化 一次 立即 
 TASK4 报警 永远 立即 100ms 
 
 　 
 
 各 模块 中 ， 利用 提供 的 虚拟 标识 来 记录 各 次 控制 量 ， 它 的 值 存在 数据中心 内 ， 具有 全局性 和 开放性 ． 
 　 　 实时控制 时 ， 为了 防止 kv0 设置 过大而达 不到 稳态 值 或 人为 产生 输出 振荡 ， kv0 的 设置 应从 百分位 开始 ． 当 输出 超调 过 大 ， 应适当 减小 kv0 ； 当 输出 跟踪 不上 设定值 ， 应适当 增大 kv0 ； 若 控制 量 u ( k ) 持续增长 直到 上 限值 ， 说明 kv0 设置 太 大 ， 应 大幅度降低 ； 若 控制 量 u ( k ) 变化 甚微 ， 以至于 输出 值 持续 缓慢 增长 或 缓慢 降低 ， 说明 kv0 设置 太小 而 使 神经元 失去 了 自 学习 能力 ， 应 大幅度 的 增大 kv0 ． 
 　 　 当 采样 周期 取 25s ， 设定值 80 ℃ ， 取 kv0 = 0.0011 ， 在 5 个 小时 内 的 炉温 输出 曲线 如图 3 所示 ． 当权 值 已 趋于 稳态 值 ， 控制 量 已 基本 不变 时 ， 炉温 输出 有 0.7 ℃ 以内 的 正 偏差 ， - 1.2 ℃ 以内 的 负 偏差 ， 满足 控制精度 要求 ． 
 
 图 3 神经元 自 适应 预测 PID 控制器 温度 
 　 　 图 4 为 图 3 的 控制 量 曲线 ． 若 在 75 ℃ 以前 采用 纯 比例控制 ， 在 75 ℃ 时 切换 为 提出 的 新 算法 ， 如图 5 所示 控制 超调 小 ， 偏差 在 ± 0.6 ℃ 以内 ， 控制 效果 更佳 ． 
 　 　 　 　 　 
 　 　 　 　 图 4 控制 量 曲线 　 　 　 　 　 　 　 　 　 　 　 图 5 改进 初始 控制策略 的 温度 实时控制 结果 
 4 　 结论 
 　 　 提出 的 神经元 自 适应 预测 PID 控制器 ， 能够 提高 控制系统 的 自 适应能力 和 鲁棒性 ， 克服 了 被控 过程 的 时滞 ． 该 控制器 结构 简单 ， 易于 实现 ， 只要 设置 合适 的 kv0 值 ， 即可 得到 满意 的 控制 效果 ． 
 注释 ： 清华大学 智能 技术 与 系统 国家 重点 资助 项目 ； 甘肃省 自然科学 基金 资助 项目 ； 
 作者简介 : 　 杨 　 智 ， 男 ， 37 岁 ， 教授 ． 研究 领域 为 过程 控制 ， 智能 控制 及大 时滞 系统 的 稳定性 及 控制策略 等 ． 
 　 　 　 　 　 　 高 　 靖 ， 女 ， 25 岁 ， 硕士生 ． 研究 领域 为 过程 控制 ， 智能 控制 等 ． 
 作者 单位 ： 甘肃工业大学 电气 与 信息工程 系 　 兰州 　 730050 
 参考文献 
 1 　 LuiXiyuan , MansurM . StabilityAnalysisandStabilityConditionintheDelayIntervalsforSecond - OrderDelaySystem . INT . J . Control , 1984 , 40 ( 2 ) : 317 ～ 327 
 2 　 刘希远 , 杨智 , 陈 铁军 , 钟春 . 时变 大 时滞 极点 配置 最优 预报 自 校正 PID 控制器 . 控制 与 决策 , 1990 , 5 ( 5 ) : 19 ～ 23 
 3 　 杨智 , 刘希远 . 时变 分数 时滞 系统 最优 预报 自 校正 极点 配置 PID 控制算法 . 控制 理论 与 应用 , 1992 , 9 ( 3 ) : 292 ～ 295 
 收稿 日期 ： 1998 - 11 - 09 
