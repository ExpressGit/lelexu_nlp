微型机 与 应用 
 MICROCOMPUTER & ITSAPPLICATIONS 
 1999 年 第 18 卷 第 1 期 Vol.18 No.11999 
 
 
 
 用 单片机 实现 HT — 12D 的 解码 功能 
 梁 华为 　 周旭 
 　 　 摘 　 要 ： 通过 分析 HT — 12D 专用 解码 芯片 的 工作 原理 ， 说明 了 用 8051 单片机 实现 解码器 功能 的 方法 。 
 　 　 关键词 ： 8051 单片机 　 HT — 12D 解码 芯片 　 编码 　 解码 　 HT — 12E 编码 芯片 
 　 　 专用 编解码 芯片 已 广泛应用 于 火灾 报警 控制系统 、 安全 防盗 系统 及其 它 一些 测控 系统 中 。 HT — 12D 是 HOLTEK 公司 生产 的 专用 解码 芯片 ， 它 与 HT — 12E 专用 编码 芯片 配套 使用 。 我们 在 TA2000 型 火灾 报警 控制系统 中 使用 了 HT — 12E / HT — 12D 专用 编 / 解码 芯片 。 在 使用 中 ， 笔者 觉得 这类 编 / 解码 芯片 有 2 方面 的 缺陷 ： 一是 要 对 编 / 解码 芯片 的 工作频率 进行 匹配 ， 而编 / 解码 芯片 的 工作频率 由 外接 电阻 电容 决定 ， 由于 电阻 和 电容 的 精度 较 低且 易受 工作 环境 ( 如 ： 温度 、 湿度 等 ) 变化 的 影响 ， 使得 编 / 解码 芯片 工作频率 的 偏差 无法控制 。 当 这种 偏差 超过 一定 范围 时 ， 就 会 使 解码 芯片 不能 正确 地 接收数据 。 二是 编 / 解码 芯片 往往 要 占用 较 多 单片机 I / O 口 资源 ， 或者 需要 设计 复杂 的 接口 电路 。 
 　 　 用 单片机 实现 解码器 功能 只 需 占用 1 位 I / O 口 ， 不但 节省 了 单片机 的 I / O 口 资源 ， 还 可 实现 解码 对 编码器 的 自动 频率 跟踪 ， 大大提高 传输 的 准确性 。 在 系统 中 ， 解码 单元 数量 较 多 ， 常有 几百 甚至 几千个 ， 而且 解码 单元 分布 在 控制 对象 附近 ， 要求 其 体积 尽量 小 ， 用 单片机 实现 解码 功能 可以 充分利用 单片机 资源 、 简化 电路设计 、 减小 电路板 面积 、 降低 系统 成本 。 
 1 　 HT — 12E / HT — 12D 的 工作 原理 
 　 　 HT — 12E / HT — 12D 专用 编 / 解码 芯片 是 采用 CMOS 工艺制作 的 大规模 集成电路 ， 其 管脚 排列 如图 1 。 
 
 图 1 　 管脚 分布 
 　 　 HT — 12E 接通 电源 后 处于 等待 状态 ， Dout 输出 高电平 ， 当 接收 到 1 个 有效 的 允许 发送 信号 ( 14 脚 TE 为 低电平 ) 时 ， HT — 12E 开始 传送 周期 。 在 传输 期间 ， HT — 12E 把 12 个 输入 端的 输入 信号 经 编码 由 Dout 串行 输出 。 Dout 端 输出 编码 脉冲 的 顺序 依次 为 A0 ～ A7 、 D0 ～ D3 ， 每个 传送 周期 Dout 输出 4 个 完全相同 的 地址 、 数据编码 脉冲 串 ， 每个 脉冲 串 包括 2 个 段 ： 引导 段 和 数据 段 ， 如图 2 。 数据 段 中 每位 地址 、 数据 的 逻辑 状态 的 表示 如图 3 。 
 
 图 2 　 传输 数据格式 
 
 
 图 3 　 数据 逻辑 状态 
 　 　 HT — 12D 接通 电源 后 处于 等待 状态 ， Din 有 低电平 出现 时 ， 开始 1 个 接收 过程 。 HT — 12D 接收 HT — 12E 发送 的 代码 时 ， 把 前 8 位 作为 地址 ， 后 4 位 作为 数据 ， 经 4 次 接收 ， 3 次 检验 ， 如果 接收 到 的 地址 与 解码器 的 地址 一致 ， 则 将 4 位 数据 锁存 到 D0 ～ D3 输出 端 ， 同时 ， VT 脚 输出 高电平 ， 表示 接收 到 有效 数据 。 HT — 12D 的 内部结构 如图 4 。 
 
 图 4 　 HT - 12D 内部结构 
 2 　 单片机 实现 
 　 　 以 目前 使用 较为 广泛 的 8051 系列 单片机 为例 ， 说明 用 单片机 实现 解码器 的 方法 。 解码 单元 参考 电路 如图 5 。 
 
 
 图 5 　 解码 单元 原理图 
 　 　 编码器 发出 的 编码 信号 到达 解码 单元 后 ， 经 整形 、 变换 后 接到 8051 单片机 的 第 12 脚 ( INT0 ) 。 单片机 内部 编程 为 允许 外部 中断 0 ， 触发 方式 为 边沿 触发 ( 下降 沿 ) ， 设置 定时 / 计数器 0 工作 于 定时 方式 1 ， 定时器 启动 条件 为 TR0 & INT0 ， 使 定时器 0 对 INT0 的 高电平 时间 进行 计数 。 这样 ， 当 传输 开始 后 ， 第 1 个 被 计数 的 是 引导 段 的 1 / 3 位 高电平 ， 以此 计 数值 的 1.5 倍 作为 标准 ， 把 此后 的 计 数值 和 此 标准 进行 比较 ， 若计 数值 大于 标准值 ， 则 认为 接收 到 0 ， 反之 ， 则 认为 接收 到 1 。 由于 引导 段 在 每个 字 的 每次 发送 之前 都 有 ， 所以 判断 标准 被 随时 更新 以 适应 当前 传输 ， 这 就 实现 了 频率 的 自动 跟踪 ， 避免 了 因 传输 频率 的 变动 而 影响 数据 接收 的 准确性 ， 提高 了 系统 的 稳定性 。 
 　 　 数据 接收 主要 在 中断 0 程序 中 实现 ， 中断 程序框图 如图 6 。 主程序 中 进行 初始化 时 ， 置 接收 次数 不 小于 12 。 另外 ， 主程序 中 ， 除 完成 其它 功能 外 ， 应 检测 “ 接收数据 有效 ” 标志 ， 若该 标志 有效 ， 则 从 接收缓冲区 中 读取数据 ， 并 复位 该 标志 。 
 
 
 图 6 　 TO 中断 软件 流程 
 　 　 该 技术 已 应用 于 我们 研制 的 “ TA2000 智能型 模拟量 火灾 报警 控制系统 ” 中 ， 并 取得 了 很 好 效果 。 实践证明 采用 该 技术 既 避免 了 频率 匹配 难 的 问题 ， 又 克服 了 因 阻容 元件 易受 环境因素 影响 而 造成 系统 工作 不 稳定 的 问题 ， 提高 了 系统 的 可靠性 。 
 　 　 该 技术 同样 适用 于 MC145026 / 7 / 8 和 VD5026 / 7 / 8 等 编 / 解码 芯片 。 
 作者 单位 ： 中国科学院 合肥 智能 所 ( 230031 ) 
 参考文献 
 　 1 　 张凯 . MCS — 51 单片机 综合 系统 及其 设计 开发 . 北京 ： 科学出版社 ， 1996 
 　 2 　 HOLTEK 公司 . 数据 手册 . 1997 
 ( 收稿 日期 ： 1998 - 07 - 27 ) 
