微型机 与 应用 
 MICROCOMPUTER & ITSAPPLICATIONS 
 1999 年 第 18 卷 第 4 期 Vol.18 No.41999 
 
 
 
 语音 芯片 W51300 与 单片机 的 控制技术 
 项 新建 
 　 　 摘 　 要 ： W51300 是 台湾 Winband 公司 生产 的 语音 处理 芯片 。 文中 给出 了 W51300 的 引脚 功能 ， 阐述 了 它 的 按键 控制 与 CPU 控制 2 种 模式 ， 介绍 了 它 与 单片机 AT89C2051 构成 的 交通广播 报 站 系统 的 设计 。 
 　 　 关键词 ： W51300 语音 处理 芯片 　 语音 处理 　 AT89C2051 单片机 　 语音 控制 
 　 　 Winband 公司 推出 的 外置 FlashRAM 的 语音 处理 芯片 W51300 ， 除了 支持 按键 控制 直接 话筒 和 喇叭 的 随录 随放 功能 和 快速 搜索 放音 模式 外 ， 还 具有 完善 的 CPU 微处理器 控制 模式 ， 用 单片机 能 控制 它 的 所有 功能 ， 通过 软件设计 还 能 实现 按键 控制 所达 不到 的 其它 功能 。 W51300 直接 外挂 512KB ～ 16MB 的 FlashRAM 。 其 录放 时间 最长 可达 50 多分钟 。 长时间 断电 语音 不断 失 ， 最大 可分 63 段 。 语质 ， 录放 时间 可 按 要求 进行 调节 ， 语音 清晰度 好 。 工作电压 2.5 ～ 5.5 V ， 静态 电流 0.1 μ A ， 工作 电流 15mA ， 芯片 按 工业 级 产品 性能 进行 设计 。 
 1 　 引脚 功能 
 　 　 W51300 为 32 脚 双列 直 插式 标准 封装 DIP 芯片 。 各 引脚 端 功能 如表 1 。 
 表 1 　 W51300 引脚 功能 
 引脚 名称 功 　 能 引脚 名称 功 　 能 
 1BWD 退段 端 17VCCA 模拟信号 电源 正端 
 2STOP 停止 端 18OSC 取样 频率 电阻 输入 端 
 3EOP 录放音 结束 信号 19MICREF 话筒 输入 参考 端 
 4CLK 外置 存储器 串口 时钟 20MIC 话筒 输入 
 5ADDR 外置 存储器 地址 端 21AGC 自动增益 控制 端 
 6DATA 外置 存储器 数据 端 [ 〗 22VCCD 数字信号 电源 正端 　 
 7CTRL 外置 存储器 控制 端 [ 〗 23CPUCPU 微 处理 控制 端 　 
 8MODE 外置 存储器 模式 控制 [ 〗 24SMODE 分段 控制 端 　 
 9BUSY 忙 状态 标志 位 25NOP 空 
 10LED 录音 状态 输出 端 26NOP 空 
 11VSSD 数字信号 电源 地 27RESET 复位 端 
 12VSSA 模拟信号 电源 地 28L - REC 录音 端 
 13SPK - 扬声器 放音 端 29L - PLAY 电平 放音 控制 端 
 14SPK + 扬声器 放音 端 30E - PLAY 脉冲 放音 控制 端 
 15VCCA 模拟信号 电源 正端 31ERASE 语音 清除 键 
 16NOP 空 32FWD 进位 键 
 
 2 　 按键 工作 模式 及 典型 应用 电路 
 　 　 W51300 按键 工作 模式 下 的 典型 应用 电路 如图 1 所示 。 在 录音 状态 下 ， 语音 信号 经 话筒 检拾 放大 ， 再 由 W51300 内部 的 A / D 转换器 转换 为 数字信号 ， 存储 在 外部 FlashRAM 中间 。 在 放音 状态 下 ， W51300 从 存储器 中 取出 信号 ， 经 D / A 和 噪声 处理 及 放大 后 ， 驱动 外接 喇叭 发出 原录 的 语音 。 图 1 中 ， R1 、 C1 是 话筒 自动增益 控制元件 ， R2 、 R3 为 外接 驻极体 话筒 的 偏压 电阻 。 Rosc 为 系统 频率 振荡 电阻 ， 它 决定 语音 处理 的 取样 频率 ， 也 影响 音质 的 好坏 ， 典型 取值 为 Rosc = 1.5 M Ω ， 此时 系统 的 采样 频率 为 10kHz 。 它 和 外接 存储器 的 容量 一起 决定 录放音 时间 。 配套 的 外接 存储器 有 1MB 的 F5010 和 2MB 的 F50202 种 型号 。 
 
 
 
 图 1 　 典型 应用 电路 
 　 　 录音 工作 时 ， 按住 录音 键 即 为 录音 状态 ， 松开 后 即 停止 录音 并 自动 形成 一段 。 放音 工作 有 2 种 方式 ， 按住 电平 放音 键 L 时即 放音 ， 松开 即 停止 ， 若 一直 按住 则 依次 放音 所有 段 ， 并 不间断 地 循环 放音 。 按 一下 脉冲 放音 键 E ， 即将 一段 放音 直至 结束 。 该键 也 支持 快速 搜索 模式 。 复位 键起 复位 作用 。 按 一下 再 放音 即到 第一段 的 段首 开始 。 退段 键 起 往后 跳 作用 ， 每 按 几下 就 往后 跳 几段 。 若 按键 时间 持续 超过 1s ， 即 自动 退 到 最后 一段 。 进段 键 起 往前 跳 作用 ， 每 按 几下 就 往前 跳 几段 。 若 按键 持续时间 超过 1s 即 自动 进到 最前 一段 。 停止 键起 停止 放音 作用 。 清除 键起 消除 语音 内容 作用 。 点 按 一下 清除 当前 段 的 语音 内容 ， 按住 键 时间 超过 2s 即 清除 全部 语音 内容 。 SMODE 为 分段 控制 端 ， 高电平 不 分段 ， 低电平 分段 。 CPU 为 工作 模式 控制 端 ， 高电平 为 微处理器 工作 模式 ， 低电平 为 按键 控制 模式 ， LED 为 录音 显示 端 。 录音 时 LED 输出 高电平 ， 溢出 时 LED 输出 3Hz 闪烁 信号 。 BUSY 为 放音 显示 端 。 放音 时 高电平 ， 不 放音 时 低电平 。 
 3 　 微处理器 工作 模式 及 应用 实例 
 　 　 W51300 芯片 在 CPU 工作 模式 下 提供 了 良好 的 微处理器 接口 ， 它 只用 5 个 引脚 与 CPU 相连 。 如图 2 所示 。 其中 RESET 、 ERASE 、 STOP 为 输入 信号 ， FWD 、 BWD 为 输出 信号 。 
 
 
 图 2 　 W51300 的 CPU 工作 模式 
 　 　 W51300 提供 了 可 由 CPU 控制 的 10 种 操作 方式 。 操作 方式 与 W51300 所计 的 脉冲 个数 有关 。 脉冲 计数 过程 以 CPU1 脚 信号 的 上 开沿 开始 到 1 脚 信号 的 下降 沿 为止 ， 所计 的 为 2 脚 在 这 段时间 里 的 脉冲 个数 。 计数 过程 波形 如图 3 所示 。 脉冲 个数 与 各种 操作 方式 对应 关系 如表 2 。 
 
 
 图 3 　 工作 脉冲 计数 过程 
 表 2 　 工作 脉冲 个数 与 操作 方式 对应 关系 
 1 个 脉冲 录音 
 2 个 脉冲 放音 
 3 个 脉冲 语音 内容 清除 
 4 个 脉冲 停止 录放音 
 5 个 脉冲 存储器 复位 
 6 个 脉冲 系统 复位 
 7 个 脉冲 读 当前 地址 指针 
 8 个 脉冲 读段 码 
 9 个 脉冲 存 4B 数据 到 存储器 
 10 个 脉冲 从 存储器 读 4B 数据 
 
 　 　 W51300 在 收到 CPU 的 1 个 指令 后 ， 在 3 脚 和 4 脚 上将 回送 1 个 相应 的 响应 信号 ， 如图 4 所示 。 通过 计数 3 脚 高电平 期间 4 脚 的 脉冲 个数 ， 可 知道 W51300 的 工作 状态 。 二者之间 对应 关系 如表 3 。 
 
 
 图 4 　 状态 脉冲 计数 过程 
 表 3 　 状态 脉冲 个数 与 状态 对应 关系 
 1 个 脉冲 指令 被 接收 
 2 个 脉冲 工作电压 低 
 3 个 脉冲 存储器 溢出 
 4 个 脉冲 段码 超出 
 5 个 脉冲 当前 地址 指针 错误 
 6 个 脉冲 工作 横式 未知 
 7 个 脉冲 未知 错误 
 
 　 　 根据上述 介绍 的 CPU 工作 模式 ， 我们 设计 了 一个 用 AT89C2051 控制 的 交通 报 站 系统 ， 其 硬件 框图 如图 5 所示 。 
 
 
 图 5 　 交通 报 站 系统 硬件 框图 
 　 　 按键 电路 设有 站 号键 、 放音 键 和 停止 键 。 LED 显示 电路 显示 各站 站名 汉语拼音 、 编号 以及 系统 的 工作 情况 。 W51300 完成 录放音 工作 。 AT89C2051 实现 各 部分 的 连接 与 控制 。 
 　 　 系统软件 设计 如图 6 所示 。 通过 对 按键 电路 和 显示 电路 的 管理 ， 实现 到 站 到 点 、 转弯 过 道 、 过桥 等 报 放音 功能 。 
 
 
 图 6 　 交通 报 站 系统软件 流程图 
 　 　 随着 数码 语音 技术 的 发展 ， 数码 语音 芯片 具有 的 体积小 、 无 介质 损耗 、 寿命长 、 调用 快捷 、 控制 方便 、 抗振 强度 高 、 适应 复杂 环境 等 特点 将 更为 突出 。 在 各种 工业 设备 、 家用电器 、 广告宣传 、 交通工具 、 旅游 设施 、 通信 系统 等 领域 中将 得到 广泛 的 应用 。 
 作者 单位 ： 杭州 应用 工程技术 学院 电机系 （ 310012 ） 
 参考文献 
 　 1 　 何立民 . 单片机 应用 技术 选编 . 北京 ： 北京 航空航天 出版社 ， 1997 
 　 2 　 周湘峻 . 外置 快 闪 存储器 的 语音 处理器 W5701 . 电子 世界 ， 1997 ； （ 12 ） 
 收稿 日期 ： 1998 - 10 - 26 
