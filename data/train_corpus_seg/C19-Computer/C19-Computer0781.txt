自动化 学报 
 ACTAAUTOMATICASINICA 
 1999 年 第 25 卷 第 6 期 Vol.25 No.61999 
 
 
 
 空气 预热器 供风 系统 的 模型 辨识 
 与 稳态 优化 控制 1 ) 
 刘 　 丁 　 万 百五 
 摘 　 要 　 利用 多层 前向 神经网络 ， 对 电站 锅炉 回转式 空气 预热器 供风 系统 在 不同 输入 作用 时 的 系统 稳态 模型 进行 了 辨识 . 比较 了 风温 、 风压 对系统 的 影响 . 提出 了 基于 神经网络 的 供风 系统 模型 ， 并 以此 模型 为 基础 提出 了 稳态 优化 算法 ， 实现 了 回转式 空气 预热器 供风 系统 的 稳态 优化 控制 ， 经济效益 显著 . 
 关键词 　 神经网络 ， 系统 辨识 ， 稳态 优化 控制 ， 空气 预热器 . 
 MODELIDENTIFICATIONANDSTEADY - STATEOPTIMIZING 
 CONTROLOFWINDSYSTEMFORAIRPREHEATER 
 
 LIUDing 
 ( Xi ' anUniversityofTechnology , Xi ' an 　 710048 ) 
 WANBaiwu 
 ( Xi ' anJiaotongUniversity , Xi ' an 　 710049 ) 
 Abstract 　 　 Thispaperusesamulti - layerforwardneuralnetworktoidentifythesteady - statemodelofairpreheaterofdifferentinputs . Theeffectsofthewindtemperatureandwindpressureonthesystemmodelarecompared , andthentheneuralnetworkwindsystemmodelisgiven . Basedonthismodel , anon - lineautomaticalmodellearningmethodandsteady - stateoptimizingalgorithmareproposedforthewindsystemofairpreheater . 
 Keywords 　 Neuralnetwork , systemidentification , steady - stateoptimizingcontrol , airpreheater . 
 
 1 　 引言 
 　 　 回转式 空气 预热器 是 大型 火力发电厂 中 广泛 使用 的 设备 ， 其 原理 如图 1 所示 . 由于 本身 结构 的 原因 ， 在 使用 过程 中 存在 因 机械 变形 而 产生 的 漏风 问题 ， 使 机组 难以 满负荷 运行 . 文献 ［ 1 ］ 提出 了 解决 这一 问题 的 模糊控制 方法 并 在 实际 使用 中 收到 了 良好 的 效果 . 本文 进一步 研究 了 系统 中 风压 、 风温 与 负荷 间 的 关系 ， 采用 神经网络 辨识 方法 ， 建立 了 这 一 复杂 控制 对象 的 模型 ， 并 以此 为 基础 实现 了 系统 的 实时 在线 优化 控制 ， 使 机组 在 满足 负荷 要求 时 ， 一 、 二次 风机 电流 为 最小 . 达到 了 节能降耗 、 提高 锅炉 燃烧 效率 的 目的 . 
 
 
 图 1 　 回转式 空气 预热器 原理图 
 2 　 供风 系统 的 模型 辨识 
 　 　 使用 神经网络 辨识 控制系统 稳态 特性 的 原理 是 通过 采集 系统 的 稳态 输入 、 输出 数据 构成 一组 学习 样本 集 ， 依 此 样本 对 神经网络 进行 训练 使 网络 逼近 系统 的 稳态 特性 ， 这种 逼近 也 可 看 成为 一种 映射 变换 . BP 神经网络 就是 能够 实现 这种 映射 变换 的 前 向 型 神经网络 中 最 常用 的 一种 . 本文 针对 空气 预热器 供风 控制系统 ， 构造 了 一个 前向 多层 网络 ， 基于 改进 的 BP 学习 算法 和 实际 测得 的 输出 、 输入 数据 ， 对 网络 进行 训练 ， 得到 了 系统 的 稳态 神经网络 模型 . 
 2.1 　 改进 的 BP 学习 算法 
 　 　 改进 的 BP 算法 的 主要 思想 是 其 学习 步长 η 应当 是 能 自 调整 的 ， 它 可以 由 以下 的 关系 递推 ［ 2 ］ 
 
 其中 τ 是 η ( n ) 的 调节 系数 ， 是 误差 函数 对 η ( n ) 的 偏 导数 . 
 　 　 该 算法 的 主要 缺点 是 计算 量 大 ， 且 训练 次数 并 没有 明显 地 减少 . 因此 可 考虑 一种 自 适应 变 步长 的 快速 BP 算法 ［ 3 ］ ， 其 基本 思想 是 ， 若 连续 两次 迭代 误差 梯度 的 符号 相反 ， 则 意味着 沿 这 一 方向 下降 过多 ， 应对 其罚 ， 减小 步长 ； 相反 ， 若 连续 两次 迭代 使 符号 相同 ， 则 表明 下降 慢 了 ， 没有 达到 极小 点 ， 应对 其奖 ， 增加 步长 . 这样 ， 通过 记忆 梯度方向 符号 变化 的 频度 信息 ， 实现 自 适应 变 步长 算法 . 具体 计算 如下 ： 
 　 　 1 ) 对 权值 及 阈值 进行 初始化 ； 
 　 　 2 ) 对于 所有 样本 ， ( a ) 从 输入 层到 输出 层 依次 计算 网络 各层 输出 ， ( b ) 从 输出 层 、 输入 层 反向 计算 各层 的 误差 ， 并 计算 各层 的 E / ui ; 
 　 　 3 ) 修正 权值 
 　 　 ( 1a ) 
 　 　 ( 1b ) 
 　 　 ( 1c ) 
 　 　 ( 1d ) 
 上式 中 0 ＜ ε ＜ 1 ， 可取 0.2 ～ 0.3 ， 视 实际 情况 而定 ； α 为 冲量 因子 ， 常取 0.8 ～ 0.9 ； 
 
 　 　 在 权值 修改 时 ， 在 每个 加权 调节 量 上加 一项 正比 于 前次 加权 变化 量 的 值 ， 使 调节 过程 向着 凸点 的 方向 变化 ， 而 不 产生 大 的 摆动 ， 起到 缓冲 平滑 的 作用 . 
 2.2 　 风压 作用 时 的 系统 模型 辨识 
 　 　 对于 三分 仓 回转式 空气 预热器 ， 空气 侧 分为 一次 风侧 和 二次 风侧 . 一次 风压 和 二次 风压 的 变化 对 锅炉 负荷 影响 很大 ， 而且 它们 之间 呈 复杂 的 非线性 关系 . 为 实现 稳态 优化 控制 ， 本文 选择 BP 神经网络 对系统 进行 建模 ， 求得 系统 的 稳态 非线性 模型 
 　 　 ( 2 ) 
 其中 x1 , x2 , x3 , x4 分别 表示 风压 和 风温 ， P 表示 锅炉 负荷 ， W 为 网络连接 权值 . 
 　 　 在 图 1 所示 系统 中 ， 忽略 风温 对 锅炉 负荷 的 影响 ， 仅 考虑 风压 对系统 的 作用 . 辨识 网络 的 结构 如图 2 所示 . 其中 输入 层有 两个 神经元 ， 分别 对应 一次 风压 x1 和 二次 风压 x2 ； 输出 层有 一个 神经元 ， 对应 于 锅炉 负荷 P ； 中间 隐层 神经元 数目 根据 输入 变量 数目 来 选择 ［ 4 ］ . 
 
 
 图 2 　 两 输入 神经网络 模型 结构图 
 　 　 网络 的 训练 采用 文献 ［ 3 ］ 给出 的 方法 ， 其权值 修正 算法 如 ( 1 ) 式 所示 . 从 生产 现场 测取 120 组 数据 ， 去除 个别 有误 的 数据 及 可能 的 动态数据 ， 从中 选取 80 组 数据 作为 训练样本 ， 30 组 数据 作为 检验 用 . 由于 系统 中 输入输出 量 的 变化 范围 比较 集中 ， 一次 风压 变化 范围 为 12.0 kp ～ 15.2 kp ; 二次 风压 变化 范围 为 1.4 kp ～ 4.0 kp ； 负荷 变化 范围 为 184MW ～ 302MW . 为 加速 收敛 ， 需对 输入输出 数据 进行 压缩 ， 即 
 　 　 ( 3 ) 
 　 　 ( 4 ) 
 　 　 ( 5 ) 
 　 　 实验 证明 ， 采用 这种 数据处理 方法 比 一般 的 处理 方法 = x / xmax 优越 ， 使 网络 的 收敛 速度 加快 . 经过 约 3 　 000 次 的 训练 ， 各 训练 点 的 误差 为 0.001 以下 ， 总均方 误差 为 10 - 5 . 此时 得到 的 网络 模型 即为 供风 控制系统 在 风压 作用 时 的 数学模型 . 将 剩余 的 30 个点 数据 作为 检验 数据 代入 网络 检验 建模 的 结果 ， 其中 有 3 个点 的 误差 超过 了 5% ， 其余 均 在 5% 以下 ， 说明 所得 的 神经网络 模型 具有 较 高 的 精度 . 
 2.3 　 风压 、 风温 作用 时 的 系统 模型 
 　 　 前面 建立 的 系统 两 输入 稳态 非线性 模型 ， 由于 忽略 了 风温 的 影响 ， 故 不能 完全 地 反映 系统 模型 的 内在 规律 . 事实上 ， 在 建模 过程 中 考虑 一次 风 温和 二次 风温 的 影响 是 十分必要 的 . 在 考虑 风温 对系统 的 影响 时 ， 仍 采用 图 2 所示 网络 ， 系统 的 输入 层 神经元 数目 为 4 个 ， 分别 对应 于 一次 风压 、 二次 风压 、 一次 风 温和 二次 风温 ； 输出 层 神经元 数目 为 1 个 ， 对应 于 锅炉 负荷 . 网络 的 训练 同样 采用 改进 的 BP 算法 ， 训练样本 也 与 两 输入 模型 相同 . 经过 大约 10 　 000 多次 训练 ， 耗时 近 3 小时 ， 训练 点 误差 为 0.001 以下 ， 总均方 误差 为 10 - 5 . 将 剩下 的 没有 参加 训练 的 数据 代入 网络 检验 其 结果 ， 所有 点 的 误差 均 在 5% 以下 ， 其中 误差 最大 为 4.98% ， 大部分 点 误差 在 1 ～ 2% 左右 . 与 两 输入 模型 相比 ， 建模 精度 有所提高 . 
 　 　 通过 对 电站 锅炉 空气 预热器 供风 系统 进行 基于 神经网络 的 模型 辨识 ， 将 这 一 复杂 热力 系统 模型 化 ， 验证 了 机组 的 负荷 不仅 与 原来 意义 上 的 漏风 有关 ， 而且 还 与 空气 预热器 中 的 风压 和 风温 有关 ， 为 进一步 实现 对系统 的 稳态 优化 控制 奠定 了 基础 . 
 3 　 空气 预热器 供风 系统 的 稳态 优化 控制 
 　 　 根据上述 辨识 所得 的 神经网络 模型 ， 采用 本文 提出 的 优化 算法 ， 就 可以 得到 在 任一 给定 负荷 下 的 最优 一次 风压 和 二次 风压 . 本 系统优化 的 目标 是 在 机组 负荷 为 一定 的 情况 下 ， 使 一次 风压 和 二次 风压 之 和 最小 . 风压 之 和 最小 即 意味着 一次 风机 和 二次 风机 电流 最小 ， 风机 的 输入 功率 也 就 相应 最小 ， 从而 达到 合理 配风 、 减小 厂用电 、 节能降耗 的 目的 . 
 3.1 　 系统优化 问题 的 描述 
 　 　 系统 的 神经网络 模型 为 P = f ( x1 , x2 , x3 , x4 ) ｜ W . 根据 实际 工况 ， x1 , x2 , x3 , x4 应 满足 以下 变量 约束 ： x1 ∈ ( 12.0 ， 15.2 ) ， x2 ∈ ( 1.8 ， 4.0 ) ， x3 ∈ ( 300 ， 340 ) ， x4 ∈ ( 310 ， 360 ) ， 以及 P = f ( x1 , x2 , x3 , x4 ) ｜ W . 
 　 　 选择 一次 风压 与 二次 风压 之 和 作为 系统优化 的 目标 函数 ， 即 J = x1 + x2 . 因此 ， 系统优化 问题 可 描述 如下 ： 
 min : J = x1 + x2 , 　 　 ( 6 ) 
 等式 约束 ： 　 P = f ( x1 , x2 , x3 , x4 ) ｜ W , 
 不等式 约束 ： 12.0 ＜ x1 ＜ 15.2 ， 
 1.8 ＜ x2 ＜ 4.0 ， 
 300 ＜ x3 ＜ 340 , 
 320 ＜ x4 ＜ 360 , 
 式 中 P 为 任一 给定 的 要求 负荷 ， 一般 P 应 满足 180 ＜ P ＜ 310 . 
 　 　 通过 对 以上 优化 问题 的 求解 ， 可以 得 出任 一 给定 负荷 下 的 最优 一次 风压 和 二次 风压 ， 即 x * 1 = f1 ( P ) , x * 2 = f2 ( P ) . 这 就是 系统 的 最优控制 曲线 . 通过 实验 证明 ， 在 机组 进入 稳态 运行 中风 温 的 有限 变化 对系统 负荷 影响 较 小 ， 因此 在 对 本 系统 进行 稳态 优化 控制 时 ， 将 一次 风 温和 二次 风温 仅 作为 系统 的 状态变量 ， 只 要求 满足 约束条件 即可 . 
 3.2 　 优化 控制算法 
 　 　 与 一般 优化 问题 相比 ， 本 系统优化 问题 具有 以下 特点 ： 
 　 　 1 ) 系统 模型 即 等式 约束 P 在 系统 的 优化 过程 中是 不 允许 变化 的 ， 这 是因为 在 发电机组 运行 过程 中 ， 机组 的 输出功率 是 由 电网 负荷 决定 的 ， 一般 不能 人为 任意 改变 ； 
 　 　 2 ) 变量 x1 , x2 的 可行 域 相对 较 小 ， 便于 利用计算机 进行 直接 搜索 寻优 ； 
 　 　 3 ) 由于 本 系统 的 优化 过程 要求 在线 、 实时 进行 ， 因此 ， 优化 控制算法 必须 简单明了 ， 具有 较强 的 可读性 ， 便于 运行 人员 掌握 . 
 　 　 鉴于 以上 特点 ， 从 简化 优化 过程 、 提高 自控 系统 投入 率 的 目的 出发 ， 在 不 考虑 风温 对系统 影响 的 条件 下 ， 将 ( 6 ) 式 所 给出 的 系统优化 问题 重新 描述 为 
 minJ = x1 + x2 , 　 　 ( 7 ) 
 　 　 等式 约束 ： 　 P = f ( x1 , x2 ) ｜ w , 
 　 　 不等式 约束 ： 12.0 ≤ x1 ≤ 16.0 ， 
 　 　 　 　 　 　 　 　 1.5 ≤ x2 ≤ 4.5 . 
 　 　 为 方便 起 见 ， 设 x1 ∈ X1 = ［ 12.0 ， 16.0 ］ ， x2 ∈ X2 = ［ 1.5 ， 4.5 ］ ， 则 空气 预热器 漏风 系统 的 优化 控制算法 如下 ： 
 　 　 1 ) 将 由 人工神经网络 辨识 得到 的 系统 模型 P = f ( x1 , x2 ) | w 装入 系统 上位 机中 ， 当 机组 负荷 稳定 时 ， 采集 风压 信号 ， 构成 一组 新 的 样本 ( P , x1 , x2 ) | w , 其中 x1 ∈ X1 , x2 ∈ X2 , 依 此 样本 对原 系统 的 神经网络 稳态 模型 进行 修正 ， 得到 新 的 网络 模型 
 P = f ( x1 , x2 ) ｜ wN ; 　 　 ( 8 ) 
 　 　 2 ) 将 x1 和 x2 的 可行 域 按 一定 步长 分 成为 n 和 m 个 小 区间 ， 即 xi1 和 xj2 ， 且 有 ( xi1 , xj2 ) ∈ X1 × X2 , 其中 i ∈ n , j ∈ m ; 
 　 　 3 ) 将 每 一组 ( xi1 , xj2 ) , 代入 ( 8 ) 式 ， 计算 
 PK = f ( x1 , x2 ) | wN , 　 　 K = 1 , 2 , … ， n × m , 　 　 ( 9 ) 
 将 PK 与 P 进行 比较 ， 若 ｜ PK - P ｜ ≤ ε ， 即 其 差值 小于 或 等于 某个 设定值 ， 则 将 此 PK 值 保留 ； 
 　 　 4 ) 在 满足 ｜ PK - P ｜ ≤ ε 的 若干个 PK 中 ， 依次 计算 J = x1 + x2 , 并 找出 系统 性能指标 函数 的 最小值 minJ ， 此时 ， 对应 的 一组 ( x * 1 , x * 2 ) 即 为 最优控制 变量 ， 以此 变量 作为 控制 信号 送入 中央 计算机系统 ， 经过 处理 后 ， 发出 控制 命令 ， 调整 一次 风压 和 二次 风压 ； 
 　 　 5 ) 定时 采样 机组 负荷 值 ， 当 机组 进入 某一 稳定 负荷 时 ， 重复 上述 过程 ， 找出 与 此 相对 应 的 最优 输入 变量 . 
 　 　 在 机组 运行 过程 中 ， 采用 以上 优化 控制算法 ， 经过 实际 系统 的 运行 和 实验 ， 得到 了 机组 在 不同 负荷 ( 180MW ～ 300MW ) 时 的 最优 一次 风压 曲线 和 二次 风压 曲线 ， 如图 3 所示 . 
 
 
 ( a ) 最优 一次 风压 / 负荷 曲线 
 
 
 ( b ) 最优 二次 风压 / 负荷 曲线 
 图 3 　 最优 一次 风压 和 二次 风压 曲线 
 3.3 　 系统优化 控制 的 实现 
 　 　 本文 设计 的 小型 分布式 供风 计算机 控制系统 下位 机以 80C31 单片机 为 核心 ， 完成 数据 采集 与 处理 、 显示 、 手 自动 切换 、 故障 报警 、 数据通讯 等 功能 . 在 上位 机中 ， 根据 系统 的 风压 、 风温 以及 锅炉 的 负荷 对 事先 建立 的 神经网络 稳态 模型 进行 在线 学习 . 由于 锅炉 负荷 和 风压 、 风温 的 变化 缓慢 ， 在 离线 辨识 所得 模型 的 基础 上 ， 每次 学习 的 样本 只有 一个 ， 所以 学习 时间 短 ， 不 影响 系统 工作 . 在 进行 优化 计算 后 ， 得出 了 所 要求 的 负荷 下 的 最优 一次 风压 和 二次 风压 ， 将 此 变量 送 至 中央 计算机系统 ( 如 INF90 系统 ) 并 发出 相应 控制 信号 ， 分别 调整 有关 参数 ( 如 总 风量 ， 送 引风机 输出功率 ) ， 以 保证 控制 要求 的 实现 . 对于 下位 机 来说 ， 除了 保证 风 侧向 烟气 侧 的 间隙 最小 外 ， 还要 调整 一次 风侧 与 二次 风侧 之间 的 间隙 ， 保证 风压 分配关系 ， 使 系统 运行 在 最佳 状态 . 图 4 为 系统控制 总体 框图 . 
 
 
 图 4 　 系统控制 总体 框图 
 3.4 　 实验 结果 
 　 　 以 某 电厂 A 侧 空气 预热器 为例 ， 实验 数据 见 下表 . 由表 可见 ， 稳态 优化 投入 后 ， 不仅 系统 漏风 率 明显 减小 ， 一次 风机 、 送 引风机 电流 也 有 不同 程度 的 减小 ， 从而 达到 了 节约 厂用电 的 目的 . 
 表 1 　 稳态 优化 控制 投运 实验 数据 
 
 项目 投运 前 投运 后 
 机组 负荷 ( MW ) 290290 
 入口 氧量 RO ′ 2 ( % ) 16.0315 . 1 
 出口 氧量 RO ″ 2 ( % ) 14.1113 . 5 
 漏风 率 A1 ( % ) 16.411 . 3 
 一次 风机 电流 ( A ) 9165 
 送风机 电流 ( A ) 8861 
 引风机 电流 ( A ) 177174 
 
 
 4 　 结束语 
 　 　 本文 建立 了 电站 锅炉 回转式 空气 预热器 供风 系统 的 神经网络 稳态 模型 ， 并 提出 了 实现 系统 稳态 优化 控制 的 方法 . 该 优化 控制系统 投入使用 后 ， 在 保证 机组 出力 不变 时 ， 使 一次 风机 和 送风机 电流 分别 下降 了 23% 和 20% ， 节能 效果 十分 明显 . 同时 ， 由于 控制 方法 原理 简单 ， 可操作性 强 ， 现场 运行 人员 易于 掌握 ， 从而 保证 了 控制系统 的 投入 率 . 本 系统 已 在 全国 20 余座 大型 火力发电厂 投入 实际 运行 ， 累计 创造 直接 经济效益 过 亿元 ， 成为 国家 科技成果 重点 推广 计划 项目 ， 1997 年 获 国家 科技进步 三等奖 . 
 1 ) 国家 科技成果 重点 推广 计划 项目 . 
 作者简介 ： 刘 　 丁 　 1957 年生 . 1997 年 获 西安交通大学 系统工程 研究所 博士学位 ， 现为 西安 理工大学 自动化 与 信息 工程学院 院长 ， 教授 . 长期 从事 工业 自动化 、 智能 控制 理论 与 应用 等 方面 的 研究 ， 目前 承担 多项 国家 重点 科研任务 ， 发表 论文 20 余篇 ， 获 国家 及 省部级 科技 进步奖 4 项 . 
 　 　 　 　 　 万 百五 　 见 本刊 第 17 卷 第 1 期 . 
 作者 单位 ： 刘 　 丁 　 西安 理工大学 自动化 学院 　 西安 　 710048 
 　 　 　 　 　 万 百五 　 西安交通大学 系统工程 研究所 　 西安 　 710049 
 参考文献 
 1 　 LiuD , WanBW . On - linecoordinativefuzzycontrolofactiveleakagecontrolsystemforpowerstationboiler . ㊣ FAC / IFORS / IMACSSymposiumonLarge - ScaleSystemsTheoryandApplication , London : Pergamonpress , 1995 , 2 : 386 ～ 392 
 2 　 万 百五 ， 黄正良 . 大 工业 过程 计算机 在线 递阶 稳态 优化 控制 . 北京 ： 科学出版社 ， 1998.222 ～ 229 
 3 　 刘丁 ， 浅田 . 神经网络 学习 的 加速 算法 ( 日文 ) . 见 ： 日本 情报 通讯 学会 春季 大会 论文集 ， 东京 ： 日本 电子情报 通信 学会 ， 1992 ( 6 ) ： 157 ～ 158 
 4 　 HuntKJ . Neuralnetworksforcontrolsystem — — Asurvey . Automatica , 1992 , 28 ( 6 ) : 1088 ～ 1111 
 5 　 万 百五 ， 林 　 杰 . 大规模 工业 过程 稳态 递阶 优化 控制 综述 . 自动化 学报 ， 1990 ， 16 ( 2 ) ： 186 ～ 192 
 收稿 日期 　 1998 - 03 - 11 　 收 修改稿 日期 　 1998 - 10 - 13 
