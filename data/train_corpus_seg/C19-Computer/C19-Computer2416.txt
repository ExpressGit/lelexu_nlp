计算机 研究 与 发展 
 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 
 1999 年 　 第 36 卷 　 第 11 期 　 Vol.36 　 No.11 　 1999 
 
 
 
 VR 环境 图像 生成 中 几项 关键技术 研究 
 于 洪川 　 吴福朝 　 阮宗才 　 韦 　 穗 
 摘 　 要 ： 文中 讨论 了 基于 图像 的 VR 环境 图像 生成 中 ， 未 标定 旋转 图像 序列 的 插 补 、 整合 及 全景图 的 生成 3 项 关键技术 问题 ， 并 给出 插补 、 整合 及 全景图 生成 方法 . 所 给 方法 有 以下 优点 ： 插补 和 整合 图像 是 源 图像 对应 的 摄像机 在 新 视点 下 的 视图 ， 这 保证 了 插 补 和 整合 图像 的 真实性 ； 控制参数 α 变化 ， 可 得到 所 需 视点 方向 的 插 补 与 整合 图像 ， 即 可以 控制 视点 方向 ； 在 此基础 上 开发 的 切点 累积 全景图 生成 技术 克服 了 传统 方法 中 技术 缺陷 ， 实用性 强 ； 此外 ， 所 给 方法 不 需要 事先 标定 摄像机 . 实验 表明 该 方法 处理 简单 ， 效果 理想 . 
 关键词 ： 匹配 矩阵 ， 图像 插补 ， 图像 整合 ， 全景图 生成 
 中图法 分类号 ： TP391 
 THESTUDYOFSEVERALKEYTECHNIQUESIN 
 BUILDINGVRVISUALFIELD 
 YUHong - Chuan , WUFu - Chao , RUANZong - Cai , andWEISui 
 ( InstituteofArtificialIntelligence , AnhuiUniversity , Hefei230039 ) 
 Abstract 　 Inthispaper , threekeytechniquesarediscussedinbuildingVRvisualfieldbasedonrealimages . Theyareinterpolation , registration , andpanoramaofuncalibratedrotatingimagesequence . Themeritsoftheirimplementedmethodsincludethefollowing , ( 1 ) Theinterpolated ( registration ) imageaccordswithperspectivegeometry . Thisoneensuresthattheinterpolated ( registration ) imageisreal ; ( 2 ) Whenthecoefficient ( α ) ischanged , theinterpolated ( registration ) imagescorrespondingtodifferentviewscanbeobtained . Itmeansthattheviewdirectioncanbecontrolled ; ( 3 ) Thetac - pointcumulationmethodofpanoramicimagesovercomessomedrawbacksinthepreviousmethods ; ( 4 ) Thecameraneedn ' tbecalibrated . Theexperimentindicatesthattheeffectisveryideal . 
 Keywords 　 matchedmatrix , imageinterpolation , imageregistration , panoramicimages 
 1 　 引 　 言 
 　 　 基于 真实 图像 的 VR 环境 生成 技术 的 研究 ， 是 目前 VR 技术 研究 中 最为 活跃 的 研究课题 之一 . 与 传统 计算机 图形学 中 重构 场景 的 根本 区别 在于 ： 它 不 依赖于 几何 模型 ， 而是 利用 事先 获取 的 一组 图像 序列 ， 对 环境 进行 编码 ， 并 通过 适当 地 变换 这些 图像 生成 位于 不同 视点 的 新 视图 ， 最终 实现 环境 的 完全 漫游 . 其 最 礧 优点 在于 ， 生成 的 环境 是 这组 图像 所 反映 的 客观 真实 场景 . 它 涉及 到 下述 3 个 基本 问题 ： 
 　 　 ( 1 ) 给定 某一 真实 场景 的 两个 不同 视点 下 的 场景 图像 ， 如何 生成 这 两个 视点 间 新 的 场景 图像 ， 即 图像 插补 问题 ； 
 　 　 ( 2 ) 给定 某个 真实 场景 的 一组 局部 图像 ， 如何 生成 包含 这组 局部 图像 的 新 视图 ， 即 图像 整合 问题 ； 
 　 　 ( 3 ) 如何 将 多幅 实景图 像 拼接 成 全景图 . 
 　 　 对于 第 1 个 基本 问题 ， 目前 大多 使用 ImageMorphing 技术 ， 所有 的 方法 都 是 基于 源 图像 间 的 像素 位置 和 颜色 的 内 插 ， 所 生成 图像 的 真实性 没有 判断 标准 . 一个 自然 的 真实性 标准 应是 ： 所 获得 插补 图像 是否是 同一 场景 或 物体 在 某个 新 视点 下 的 像 . 研究 表明 ： 现行 的 ImageMorphing 技术 不能 保证 这 一点 ， 即使 是 2D 场景 也 不行 . Seitz 等 人 ［ 1 ］ 提出 的 ViewMorphing 技术 能 保证 插补 图像 的 真实性 ， 但 事先 需 已知 摄像机 内外 参数 或 已知 场景 的 深度 信息 . 如何 从未 标定 图像 序列 中 插 补出 所 需 视图 则 是 我们 研究 重点 . 在 文献 ［ 2 ］ 中 我们 提出 一种 与 视点 对应 的 未 标定 图像 序列 视图 插补 技术 ， 这种 技术 能够 保证 插补 图像 是 某 一 摄像机 在 某 一新 视点 下 的 视图 ， 即 物理 可 实现 ， 因而 克服 了 ViewMorphing 技术 的 缺陷 . 但 如何 获得 与 当前 摄像机 对应 的 插 补 图像 ， 如何 得知 与 插 补 图像 对应 的 视点 的 方位 及 姿态 ( 方向 ) ， 这些 仍 有待 进一步 研究 . 本文 仅 针对 未 标定 旋转 图像 序列 提出 一种 与 当前 摄像机 在 某 一 确定 姿态 下 对应 的 视图 插补 技术 . 
 　 　 对于 第 2 个 基本 问题 ， 其 核心 是 寻找 一个 变换 ， 使 图像 间 相 重叠 的 部分 对准 ， 并 “ 缝合 ” 成 一个 新 的 更 大 视场 范围 的 视图 . 这 就 涉及 到 图像 间 匹配 部分 的 对应 关系 和 实现 对应 部分 对准 所 需 的 变换 . 目前 大多 使用 的 技术 所 获得 的 整合 图像 难以 保证 透视 关系 . 本文 讨论 由 摄像机 旋转 运动 产生 图像 序列 的 像 整合 问题 ， 所 给 方法 有 以下 优点 ： 整合 图像 仍 满足 透视 几何 关系 ， 这 保证 了 整合 图像 的 真实性 ； 整合 参数 的 变化 ， 对应 于 在 不同 视点 下 的 整合 ， 即可 得到 不同 视点 下 的 整合 图像 ； 此外 ， 该 方法 不 需要 事先 标定 摄像机 . 
 　 　 对于 第 3 个 基本 问题 ， 目前 全景图 基本 可 分为 柱面 、 球面 、 立方体 等 形式 ， 以 柱面 全景图 最易 实现 而 普遍 采用 ［ 4 , 5 ］ . 传统 的 构造 全景图 方法 是 ， 要 先 确定 相邻 图像 重叠 范围 ， 去掉 重叠 ， 接缝处 经 “ 缝合 处理 ” ， 再 拼接 成 360 ° 柱面 全景图 ［ 4 ］ . 由于 重叠 范围 确定 困难 ， 接缝处 “ 缝合 处理 ” 复杂 且 真实感 差 ， 拼接 全景图 时 要求 摄像机 预先 标定 等 技术 原因 ， 一幅 较 理想 的 全景图 构成 十分困难 . 近年来 这方面 的 研究 较 多 ， 尤以 McMillan ［ 6 ］ ， Szeliski ［ 7 ］ 等 人 工作 最为 突出 . 他们 都 是 依据 简化 的 摄像机 模型 ， 通过 图像 序列 估计 出 焦距 及 摄像机 姿态 ， 完成 对 摄像机 的 标定 ， 以此 来 生成 全景图 . 这样 做 的 直接 后果 是 处理 复杂 、 计算 累积 误差 较大 ， 下文 将作 进一步 分析 . 为 克服 了 上述 缺陷 ， 本文 提出 切点 累积 全景图 生成 技术 . 
 2 　 旋转 图像 间 的 匹配 矩阵 
 2.1 　 匹配 矩阵 定义 
 　 　 摄像机 模型 采用 针孔 模型 . 令 摄像机 先 摄取 的 图像 为 I1 ， 旋转 运动 后 摄取 的 图像 为 I2 ， 可 分为 两个 部分 Ii1 与 Ii2 ， I11 ( I21 ) 为 I2 ( I1 ) 非 重叠 部分 ， Ii2 为 运动 前后 公共 视场 部分 ( 如图 1 所示 ) . 
 
 
 图 1 　 旋转 图像 间 的 投影 关系 ( 箭头 表示 光轴 方向 ) 
 　 　 在 齐次 坐标系 下 ， 设 旋转 矩阵 为 R ， 并令 P1 = ( u1 , v1 , w1 ) ∈ I1 , P2 = ( u2 , v2 , w2 ) ∈ I2 为 空间 点 X 在 像 平面 I1 , I2 上 投影 点 ， 则 
 p1 = KX , p2 = KRX 
 其中 ， K 为 摄像机 内 参数 阵 ( 通常 有 5 个 参数 ) ， 有 
 　 　 　 　 　 　 p2 = KRK - 1p1 　 　 　 　 ( 1 ) 
 令 M = KRK - 1 = ( mij ) 3 × 3 ， 则 称 M 为 I1 到 I2 的 匹配 矩阵 . 直角坐标 系下 ， 匹配 矩阵 M 在 相差 一 常数 因子 时 是 唯一 确定 的 . 不难看出 只有 预先 已知 摄像机 内 参数 阵 K ， 才 可 采用 三 参数 算法 ［ 7 ］ 求解 M . 摄像机 未 标定 时 ， 通常 采用 八 参数 算法 ［ 8 , 9 ］ . 
 2.2 　 匹配 矩阵 的 求解 
 　 　 通过 两幅 图像 I1 , I2 之间 的 N ( ≥ 4 ) 对 匹配 点 ， 应用 八 参数 算法 可以 确定 匹配 矩阵 M 初值 . 
 　 　 ( 1 ) 求 初值 m 
 　 　 令 ( xi1 , yi1 ) ∈ I1 ， ( xi2 , yi2 ) ∈ I2 为 一对 匹配 点 ， i = 1 , 2 , … , N ， 由式 ( 1 ) 每 一对 匹配 点 可以 得到 两个 线性方程 ： 　 　 
 ( xi1 , yi1 , 1 , 0 , 0 , 0 , - xi1xi2 , - yi1xi2 ) m = xi2 
 ( 0 , 0 , 0 , xi1 , yi1 , 1 , - xi1yi2 , - yi1xi2 ) m = yi2 
 其中 ， m = ( m11 , m12 , m13 , m21 , m22 , m23 , m31 , m32 ) T 
 于是 我们 可 得到 2N 个 关于 参数 ( m11 , m12 , m13 , m21 , m22 , m23 , m31 , m32 ) 的 方程 . 写成 矩阵 形式 ： 
 Am = b 
 方阵 ATA 的 最小 特征值 所 对应 的 特征向量 ， 即为 m 的 最小 二乘解 ［ 10 ］ . 
 　 　 ( 2 ) 求精 m 
 　 　 由 最小 二 乘法 所求 的 m 是 下述 意义 
 min ‖ Am - b ‖ 
 下 的 解 ， 因此 将 ( xi1 , yi1 ) 代入 式 ( 1 ) 所得 的 与其 匹配 点 ( xi2 , yi2 ) 仍 有 一定 的 误差 . 
 　 　 下面 我们 给出 的 求 精 算法 ， 使 误差 达到 最小 . 令 
 
 显然 求精 m ， 就是 求一 具体 的 m * 使 
 G ( m * ) = minG ( m ) 
 这是 非线性 最小 问题 ， 可以 利用 Levenberg - Marquardt 算法 ［ 10 ］ 来 求解 . 该 算法 已 成为 求解 该类 问题 的 标准 方法 . Szeliski 提出 的 三 参数 算法 中 ， 则 采用 逆 Hessian 矩阵 方法 求解 3 个 参数 . 而 Levenberg - Marquardt 算法 是 在 逆 Hessian 矩阵 方法 的 极限 和 最速 下降 法 之间 作 平滑 调和 ， 即后 一 方法 在 远离 最小值 时 运用 ， 当 接近 最小值 时则 逐渐 切换 到 前 一 方法 . 从 算法 本质 来看 ， 它们 都 无法 克服 对 初始值 选取 敏感 ， 不能 保证 收敛 到 全局 最优 解等 先天 缺陷 ， 且 收敛 速度 无 明显 区别 . 而 初始值 选取 则 依赖于 摄像机 是否 严格 绕光心 旋转 ， 匹配 点 选择 是否 精确 等 因素 . 通常 初始值 误差 在 一定 范围 内 ， 利用 求精 算法 ， 可以 匹配 点 的 误差 控制 在 0.1 个 像素 范围 之内 . 初始值 误差 较大 时 ， 则 必须 事先 校正 匹配 点 . 三 参数 算法 较 八 参数 算法 突出 特点 是 ， 待定 参数 少 ， 但 它 依赖于 对 摄像机 内 参数 阵 的 估计 精度 . 
 　 　 McMillan ［ 6 ］ 试图 通过 柱面 极 几何 约束 实现 匹配 点 自动 匹配 . 而 极 几何 约束 核心 基础 矩阵 ( 或 本质 矩阵 ) 对 误差 过分 敏感 ， 导致 匹配 结果 无法 实用 . 目前 这方面 研究 还仅 局限于 匹配 点 错误 匹配 时 如何 校正 ， 而 对于 匹配 点 匹配 精度 控制 研究 刚刚 起步 ， 还 没有 一个 理论 框架 . 
 3 　 旋转 图像 序列 视图 插补 
 3.1 　 通过 旋转 图像 I1 , I2 插补 视图 I α 
 　 　 如图 1 所示 ， 摄像机 绕光心 旋转 前后 所获 两幅 图像 为 I1 , I2 ， 二者 间 的 匹配 矩阵 M = KRK - 1 ， M 与 R 有 相同 的 特征值 1 ， e ± i θ , R 是 旋转 矩阵 ， θ 为 旋转 角 . 为了 对 M 作 进一步 分解 ， 先 引述 以下 引理 ， 该 引理 在 文献 ［ 11 ］ 中 已 得到 严格 证明 . 
 　 　 引理 . 设 ti ( i = 1 , 2 , 3 ) 为 T 的 第 i 列 向量 ， 则 T 为 MT = TRz ( θ ) 的 非 奇异 解 f = t1 + it2 , = t1 - it2 , 分别 为 M 的 特征值 e - i θ , ei θ , 1 的 特征向量 . 其中 ： 
 
 　 　 根据 该 引理 摄像机 关于 光心 绕 任意 轴 旋转 所获 两幅 图像 间 的 匹配 矩阵 ， 均 可 唯一 分解 为 M = TRz ( θ ) T - 1 ， 由此 不难 构造 出 旋转 角 变为 α θ 时所 对应 的 匹配 矩阵 ： 
 　 　 　 　 M ( α ) = TRz ( α θ ) T - 1 　 　 　 ( 2 ) 
 M ( α ) 有 下述 性质 ： 
 　 　 ① M ( 0 ) = I ， I 为 单位矩阵 ； 
 　 　 ② M ( 1 ) = M ； 
 　 　 ③ M ( α ) M ( β ) = M ( α + β ) . 
 　 　 至此 ， 由 两幅 源 图像 不难 内 插出 ， 同一 摄像机 旋转 过程 中 任意 旋转 角所 对应 的 插 补 图像 I α . 定义 插补 图像 I α 中 匹配 点 P α 的 齐次 坐标 为 
 　 　 　 　 　 　 ( 3 ) 
 其中 ： 0 ≤ α ≤ 1 ， 称为 插补 参数 . 
 　 　 显然 p1 ∈ I1 与 p2 ∈ I2 为 一对 匹配 点时 
 M ( α ) ( u1 , v1 , w1 ) T = M - 1 ( 1 - α ) ( u2 , v2 , w2 ) T 
 　 　 不难看出 ， I α 对应 的 摄像机 投影 矩阵 为 Π = KR ( α θ ) ， 即 同一 摄像机 旋转 至 α θ 角所获 视图 就是 插补 图像 I α . 
 　 　 为了 式 ( 3 ) 实用化 ， 将 其 表达 为 下述 直角坐标 形式 ： 
 
 其中 ： 
 
 这里 ， ( mij ( α ) ) 3 × 3 = M ( α ) , ( mij ( 1 - α ) ) 3 × 3 = M - 1 ( 1 - α ) . 
 　 　 摄像机 未 标定 时 ， 通过 匹配 矩阵 分解 仅能 确定 两幅 图像 间 的 旋转 角 ， 而 无法 确定 旋转轴 . 插补 图像 仅 是 旋转 视点 在 旋转轴 不变 时 旋转 到 某 一 旋转 角下 所 对应 的 视图 . 当 摄像机 标定 后 ， 内 参数 阵 K 已知 ， 式 ( 2 ) 可 进一步 分解 为 
 R = K - 1MK = K - 1TRzT - 1K 
 则 特征值 1 所 对应 的 特征 矢量 n = K - 1t3 即为 旋转轴 方向 矢量 ， 通常 内 参数 阵是 难以获得 的 . 本文 主要 讨论 摄像机 未 标定 情形 . Szeliski 三 参数 算法 迭代 求解 的 3 个 参数 即 为 旋转轴 方向 矢量 ， 而 内 参数 阵则 采用 简化 形式 以便 于 预先 对 其 估计 . 
 　 　 无论 Szeliski 三 参数 算法 还是 McMillan 投影 校正 方法 ， 都 是 在 焦距 预先 估计 后 ， 迭代 校正 外 参数 ， 因此 焦距 估值 直接 影响 匹配 矩阵 M 精度 . 仅 通过 源 图像 序列 ， 难以获得 焦距 精确 估计值 ， 且 误差 较大 ， 代入 校正 的 外 参数 ， 误差 必然 被 累积 放大 ， 所 获得 的 匹配 矩阵 精度 难以 控制 . 本文 提出 的 匹配 矩阵 分解 法 ， 仅 从 原始 的 匹配 矩阵 M 出发 ， 不 做 任何 近似 和 估计 ， 将 旋转 变化 约束 为 一个 可变 因子 并 加以控制 ， 所 引入 的 误差 仅 是 计算误差 不会 被 累积 放大 ， 所 获得 的 匹配 矩阵 精度 可以 有效 控制 ， 鲁棒性 强 . 
 3.2 　 几何 解释 
 　 　 当 插 补 参数 α = 0 时 ， I1 不变 ， I2 中 I21 的 部分 被 投影 到 I ′ 1 ， 此时 插补 图像 I α = 0 = I1 ∪ I ′ 1 的 摄像机 投影 矩阵 为 Π = K ， 与 I1 相同 ， 见图 2 . 
 
 
 图 2 　 插补 参数 α = 0 时 
 　 　 当 α = 1 时 ， I2 不变 ， I1 中 I11 的 部分 被 投影 到 I ′ 2 ， 此时 插补 图像 I α = 1 = I2 ∪ I ′ 2 的 摄像机 投影 矩阵 为 Π = KR ( θ ) ， 与 I2 相同 ， 见图 3 . 
 
 
 图 3 　 插补 参数 α = 1 时 
 　 　 当 0 ＜ α ＜ 1 时 ， I1 与 I2 的 公共 视场 部分 I12 与 I22 ， 被 投影 到 I ( 1 , 2 ) α ， I11 被 投影 到 I ( 1 ) α ， I21 被 投影 到 I ( 2 ) α ， 此时 插补 图像 I α = I ( 1 ) α ∪ I ( 1 , 2 ) α ∪ I ( 2 ) α 的 摄像机 投影 矩阵 为 Π = KR ( α θ ) ， 见图 4 . 
 
 
 图 4 　 插补 参数 0 ＜ α ＜ 1 时 
 　 　 插补 参数 α 取 不同 值 ， 图像 I α 对应 于 同一 摄像机 不同 旋转 角下 的 视图 . 
 　 　 Seitz 提出 的 ViewMorphing 技术 为 实现 摄像机 平移 运动 视图 插补 ， 需要 对非 平行 视图 预先 校正 . 本文 提出 的 方法 仅限于 旋转 图像 序列 插补 ， 无须 预先 校 正视图 . 此外 ， 无须 标定 摄像机 . 
 3.3 　 生成 图像 像素 颜色 
 　 　 令 ( x α , y α ) ∈ I α ， 按 下述 公式 确定 其 颜色 ： 
 ( 4 ) 
 其中 ： c ( x , y ) 表示 点 ( x , y ) 的 颜色 . 精确 匹配 时 ， 插补点 应 满足 所 给 颜色 公式 ( 4 ) ， 如 有 误差 是 因 摄像机 未绕 光心 旋转 ， 及 光照 条件 改变 所致 ； 光照 条件 改变 会 导致 插补 图像 颜色 变化 不 连续 ， 为 确保 颜色 变化 连续 ， 可 采用 淡入淡出 法来 处理 插补 图像 ； 摄像机 未绕 光心 旋转 所 引入 的 误差 通常 会 导致 插补 图像 重影 ( 模糊 ) ， 只要 误差 不 大 ， 与 最近 邻域 法相 类似 采用 由 插 补 图像 反演 到源 图像 方法 可 有效 克服 图像 重影 ， 并 能 确定 插补 图像 重叠 范围 ， 为 颜色 值 淡入淡出 处理 提供 依据 . 
 4 　 图像 序列 的 整合 
 4.1 　 将 旋转 图像 序列 整合 为 图像 I α 
 　 　 将 任意 两张 相邻 旋转 图像 整合 ， 其 处理 方法 与 第 3 节中 视图 插补 技术 相同 . 而 对于 旋转 图像 序列 整合 则 需作 以下 变换 . 
 　 　 令 任意 两张 相邻 旋转 图像 间 匹配 矩阵 Mi = KRiK - 1 , Ri 为 图像 Ii 相对 于 Ii - 1 的 旋转 矩阵 ， 有 
 p1 = M1p0 
 p2 = M2p1 
 … … 
 pi = Mipi - 1 
 由此 不难 推出 旋转 图像 Ii 与 I0 间 匹配 矩阵 所 对应 的 旋转 矩阵 旋转 角 θ ( i ) = ∑ ik = 0 θ k ， 仿照 式 ( 2 ) 匹配 矩阵 也 有 类似 分解 
 M ( i ) ( α ) = TR ( i ) z ( α θ ( i ) ) T - 1 
 这里 ， α 被 称为 整合 参数 ， 0 ≤ α ≤ 1 . 同样 有 类似 的 整合 公式 
 
 上述 整合 公式 仅 是 首尾 两幅 图像 被 整合 在 同一 视点 下 的 变换 关系 ， 中间 图像 序列 整合 与 之 类似 ， 匹配 关系 可 递推 导出 . 
 　 　 令 ： 整合 视点 相对 于 初始 图像 I0 所 旋转 角度 为 β i = α θ ( i ) ， 首尾 图像 整合 后 ， 旋转 图像 Ii - 1 和 I1 整合 时 ， β i 与 θ ( i ) 应 作 适当 调整 ， 即 β i - 1 = β i - θ i ， θ ( i ) = θ ( i ) - θ 1 - θ i ， 则 整合 参数 调整 为 
 
 匹配 矩阵 也 应 调整 为 由此 不难 导出 n 幅 旋转 图像 序列 整合 公式 
 ( 5 ) 
 整合 图像 I α 所 对应 的 摄像机 投影 矩阵 Π = KR ( α θ ( n ) ) . 
 4.2 　 几何 解释 
 　 　 图像 整合 的 几何 意义 与 上节 视图 插补 的 几何 解释 相 类似 . 图 5 表示 3 幅 图像 整合 关系 . 可以 看到 图像 I0 , I1 , In 中非 重叠 部分 被 分别 整合 到 I ( 0 ) α , I ( 1 ) α , I ( n ) α , 重叠 部分 I02 与 I11 被 整合 到 I ( 0 , 1 ) α ， I12 与 In1 被 整合 到 I ( 1 , n ) α ， 此时 整合 图像 I α = I ( 0 ) α ∪ I ( 0 , 1 ) α ∪ I ( 1 ) α ∪ I ( 1 , n ) α ∪ I ( n ) α . 整合 参数 α 取 不同 值 ， 图像 I α 是 同一 摄像机 对应 于 不同 旋转 视点 下 的 整合 图像 . 
 
 
 图 5 　 图像 整合 的 几何 意义 
 　 　 单从 两幅 源 图像 无法 获得 绕 不同 轴 旋转 的 插 补 图像 ， 必须 增加 另 一幅 绕 不同 轴 旋转 的 源 图像 ， 仿照 式 ( 5 ) 将 相邻 两幅 图像 对 逐一 处理 ( 串型 处理 ) ， 可 获得 绕 不同 轴 旋转 的 插 补 图像 . 
 5 　 全景图 生成 
 　 　 全景 视图 ( panoramicimages ) 是 一种 利用 实景图 像 组成 全景 空间 的 技术 ， 以 柱面 全景图 最易 实现 而 普遍 采用 . AppleInc 公司 推出 的 QuicktimeVR 系统 ［ 4 ］ ， 是 通过 全景图 上 开窗口 实时 生成 用户 所 要 观察 的 虚拟环境 ， 经 不同 全景图 间 的 切换 来 实现 在 虚拟环境 中 的 漫游 ， 使 用户 能 主动 地 从 不同 视点 和 方向 了解 环境 . 全景图 生成 方法 很多 ， 但 普遍存在 相邻 图像 重叠 范围 确定 困难 ， 接缝处 “ 缝合 处理 ” 复杂 且 真实感 差 ， 拼接 全景图 时 要求 摄像机 预先 标定 等 缺陷 ， McMillan 和 Szeliski 都 未能 避免 这些 问题 . 而 本文 所 提出 的 切点 累积 全景图 生成 技术 则 有效 地 克服 了 上述 缺陷 ， 并 获得 满意 效果 . 
 　 　 如图 6 所示 投影 柱面 俯视图 ， 图像 I 投影 到 柱面 时 ， 除 切点 C 不 改变 外 ， 其它 线段 则 投影 到 弧 A ′ C ， CB ′ ， 发生 变形 ， 保留 弧 A ′ C , CB ′ 必然 会 带来 相邻 图像 间 重叠 范围 确定 ， 接缝处 “ 缝合 处理 ” 等 问题 . 因此 若 生成 360 ° 所有 旋转 视点 下 的 像 ， 并 将 其 切点 累积 ， 则 可 避免 上述 问题 并 生成 所 需 的 全景图 . 第 3 节中 提出 的 旋转 图像 序列 视图 插补 技术 ， 可 插 补出 相邻 两幅 图像 间 所有 旋转 角度 对应 的 视图 ， 因此 逐一 将 旋转 图像 序列 中 每 相邻 图像 对间 所有 旋转 角 视图 插补 出来 ， 并 累积 保留 切点 ， 即可 获得 全景图 . 需要 注意 的 是 插 补 参数 ( 变化 步长 决定 了 “ 切点 ” 部分 宽窄 ， 应 根据 图像 横向 分辨率 而定 . ) 
 
 
 图 6 　 投影 柱面 俯视图 
 6 　 实验 结果 
 　 　 运用 本文 提出 的 视图 插补 技术 实验 ， 由于 误差 会 造成 重叠 区域 插补 图像 模糊 和 色彩 过渡 不 连续 等 问题 . 通常 误差 较 小时 ， 通过 图像 反演 和 色彩 值 淡入淡出 处理 可 获得 较为 满意 的 效果 . 
 　 　 图 7 ( a ) , ( b ) , ( c ) 分别 为 摄像机 关于 光心 绕 同一 轴 旋转 所获 图像 序列 ， 图 7 ( d ) 是 这 3 幅 图像 在 同一 视点 下 的 整合 图像 . 整合 参数 α = 0 ， 即图 7 ( a ) 所 对应 的 视点 下 的 整合 . 从图 7 ( d ) 可以 看出 整合 的 结果 是 非常 理想 的 . 
 
 
 
 图 7 　 绕 同一 轴 旋转 图像 序列 的 整合 . ( a ) ， ( b ) ， ( c ) 是 源 图像 ， ( d ) 是 整合 图像 ， 整合 参数 α = 0 
 　 　 图 8 中 ( a ) , ( b ) , ( c ) , ( d ) 分别 为 摄像机 关于 光心 绕 不同 轴 旋转 所获 图像 ， ( e ) , ( f ) 是 这 4 幅 图像 在 同一 视点 下 的 整合 图像 . 整合 图像 对应 于源 图 8 ( a ) , ( d ) 间 α = 0.5 处 视点 . 
 
 
 　 　 
 图 8 　 绕 不同 轴 旋转 图像 序列 的 整合 . ( a ) , ( b ) , ( c ) , ( d ) 是 源 图像 ， ( e ) , ( f ) 是 整合 图像 ， 整合 参数 α = 0.5 
 　 　 图 9 是 通过 10 幅 旋转 图像 序列 生成 的 全景图 . 可以 看到 没有 接缝 痕迹 ， 效果 理想 . 由于 全景图 过于 细长 ， 人为 显示 拉 宽 后 纵横 比 有些 失调 . 
 
 
 图 9 　 切点 累积 法 生成 的 柱面 全景图 
 7 　 结束语 
 　 　 本文 较 圆满 地 解决 基于 图像 的 VR 环境 生成 中 ， 视图 的 插 补 、 整合 及 全景图 的 生成 3 项 关键技术 问题 . 所 给 方法 有 以下 优点 ： 插补 和 整合 图像 是 源 图像 对应 的 摄像机 在 新 视点 下 的 视图 ， 即 插 补 和 整合 图像 满足 摄像机 透视 几何 关系 ， 这 保证 了 插 补 和 整合 图像 的 真实性 ； 控制参数 α 的 变化 ， 即可 得到 视点 相对 方向 确定 的 插 补 与 整合 图像 ； 在 此基础 上 开发 的 切点 累积 全景图 生成 技术 克服 了 传统 方法 中 技术 缺陷 ， 实用性 强 ； 此外 ， 所 给 方法 不 需要 事先 知道 摄像机 的 内 、 外 参数 . 实验 也 表明 处理 简单 ， 效果 理想 . 因此 本文 所 提出 的 方法 在 虚拟现实 环境 生成 、 图像 计算 等 领域 中 必将 具有 非常 广泛 的 应用 价值 . 如何 实现 全景图 对间 的 插 补则 是 实现 虚拟现实 环境 漫游 的 关键 ， 这 也 是 我们 下 一步 研究 的 重点 . 
 * 本 课题 得到 国家自然科学基金 ( 项目编号 69875001 ) 资助 . 于 洪川 ， 男 ， 1969 年 6 月生 ， 博士 研究生 ， 主要 研究 方向 为 计算机 视觉 、 虚拟现实 技术 . 
 作者简介 ： 吴福朝 ， 男 ， 1957 年 10 月生 ， 教授 ， 主要 研究 方向 为 计算机 视觉 、 神经网络 等 . 
 　 　 　 　 　 阮宗才 ， 男 ， 1970 年 5 月生 ， 博士 研究生 ， 主要 研究 方向 为 计算机 视觉 、 虚拟现实 技术 等 . 
 　 　 　 　 　 韦穗 ， 女 ， 1946 年 2 月生 ， 教授 ， 博士生 导师 ， 主要 研究 方向 为 计算机 视觉 、 虚拟现实 技术 、 图像处理 等 . 
 作者 单位 ： 安徽大学 人工智能 研究所 　 合肥 　 230039 
 参考文献 
 1 　 SeitzSM , DyerR . Viewmorphing . In : ProcofACMSIGGRAPH96 , NewOrleans , 1996.21 ～ 30 
 2 　 YuanBo , WuFuchao , YuHongchuan , WeiSui . Imageinterpolationcorrespondencewithviewpoint . In : ProcofIntSymposiumonMultispectralImageProcessing , SPIEVol3545 , Wuhan , 304 ～ 308 
 3 　 WernerT , HerschRD , HlavacV . Renderingreal - worldobjectsusingviewinterpolation . In : ProcofACM15thIntConfonComputerVision , 1995 ( ICCV ) . 957 ～ 962 
 4 　 ChenSE . QuicktimeVR : Animage - basedapproachtovirtualenvironmentnavigation . In : ProcofACMSIGGRAPH95 , LosAngeles , 1995.29 ～ 38 
 5 　 http : / / www . bdiamon . com 
 6 　 McMillanL , BishopG . Plenopticmodeling : Animage - basedrenderingsystem . In : ProcofACMSIGGRAPH95 , 1995 , LosAngeles.39 ～ 46 
 7 　 SzeliskiR , ShumHY . Creatingfullviewpanoramicimagemosaicsandenvironmentmaps . In : ProcofACMSIGGRAPH97 , LosAngeles , 1997 
 8 　 IraniM , AnandanP , HsuS . Mosaicbasedrepresentationsofvideosequencesandtheirapplications . In : Proc5thICCV95.1995 . 605 ～ 611 
 9 　 SzeliskiR . Videomosaicsforvirtualenvironments . IEEETransComputerGraphicsandApplications , 1996 , 16 ( 2 ) : 22 ～ 30 
 10 　 PressWH , TeukolskySAetal . NumericalRecipesinC : TheArtofScientificComputing ( 2ndEdition ) . CambridgeUniversityPress , 1992 
 11 　 吴福朝 , 于 洪川 等 . 摄像机 自 标定 — 理论 与 算法 . 自动化 学报 , 1999 , 25 ( 6 ) 
 　 　 ( WuFuchao , YuHongchuanetal . CameraSelf - Calibration — TheoryandAlgorithms . ActaAutomaticaSinica ( inChinese ) , 1999 , 25 ( 6 ) 
 原稿 收到 日期 ： 1999 - 03 - 17 ； 修改稿 收到 日期 ： 1999 - 06 - 21 . 
